webpackJsonp([0],{"0MQA":function(t,e){},E3O9:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n("3cXf"),a=n.n(r),o=n("4YfN"),s=n.n(o),i=n("b8UZ"),c={name:"products",data:function(){return{productList:[],currentPage:1,pageSize:5}},computed:s()({},Object(i.c)(["user"]),{productList2:function(){var t=(this.currentPage-1)*this.pageSize,e=this.currentPage*this.pageSize;return this.productList.slice(t,e)}}),methods:{makeOrderFn:function(t){var e=this,n={userid:this.user.id,productList:[t]},r=this.$loading({lock:!0,background:"rgba(0, 0, 0, 0.5)"});this.$axios.post("shop/order/addOrder",a()(n)).then(function(t){r.close(),t&&"20000"===t.resultCode?(e.$notify({message:"订单生成成功。",type:"success"}),e.$router.push({path:"ordersDetails",query:{orderid:t.result.orderid}})):e.$notify({message:"订单生成失败。",type:"warning"})}).catch(function(t){r.close(),e.$notify({message:"订单生成接口报错。",type:"warning"})})},addShoppingCart:function(t){var e=this,n={productid:t.productid,quantity:t.quantity,userid:this.user.id};console.log(n);var r=this.$loading({lock:!0,background:"rgba(0, 0, 0, 0.5)"});this.$axios.post("shop/cart/addCart",a()(n)).then(function(t){r.close(),t&&"20000"===t.resultCode?e.$notify({message:"添加成功。",type:"success"}):e.$notify({message:"添加失败。",type:"warning"})}).catch(function(t){r.close(),e.$notify({message:"添加接口报错。",type:"warning"})})},getProducts:function(){var t=this,e=this.$loading({lock:!0,background:"rgba(0, 0, 0, 0.5)"});this.$axios.get("shop/products").then(function(n){e.close(),n&&"20000"===n.resultCode?(n.result.forEach(function(t,e){t.quantity=1}),t.productList=n.result):t.$notify({message:"获取商品列表失败。",type:"warning"})}).catch(function(n){e.close(),t.$notify({message:"获取商品表接口报错。",type:"warning"})})}},mounted:function(){},created:function(){this.getProducts()}},u=n("W5g0");var l=function(t){n("0MQA")},d=Object(u.a)(c,function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"articleBox fx-f1"},[n("el-table",{staticClass:"articleList",attrs:{data:t.productList2,border:""}},[n("el-table-column",{attrs:{label:"图片",width:"72"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("div",{staticClass:"productIcon"},[n("img",{attrs:{src:t.$ut.srcUrl+e.row.image,sizes:"48"}})])]}}])}),t._v(" "),n("el-table-column",{attrs:{prop:"cname",label:"名称"}}),t._v(" "),n("el-table-column",{attrs:{prop:"category",label:"分类"}}),t._v(" "),n("el-table-column",{attrs:{prop:"listprice",label:"单价(￥)"}}),t._v(" "),n("el-table-column",{attrs:{prop:"descn",label:"描述"}}),t._v(" "),n("el-table-column",{attrs:{label:"数量"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-input-number",{attrs:{min:1,size:"small",label:"描述文字"},model:{value:e.row.quantity,callback:function(n){t.$set(e.row,"quantity",n)},expression:"scope.row.quantity"}})]}}])}),t._v(" "),n("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.makeOrderFn(e.row)}}},[t._v("直接购买")]),t._v(" "),n("el-button",{attrs:{type:"text"},on:{click:function(n){return t.addShoppingCart(e.row)}}},[t._v("加入购物车")])]}}])})],1),t._v(" "),n("el-pagination",{attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:"total, prev, pager, next",total:t.productList.length},on:{"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1)},[],!1,l,"data-v-4337b002",null);e.default=d.exports}});
//# sourceMappingURL=0.94568f736705c2afb697.js.map